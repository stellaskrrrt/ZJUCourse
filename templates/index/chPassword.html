<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="../../static/common/img/icon.jpg" rel="icon">
    <link href="../../static/common/css/bootstrap.min.css" rel="stylesheet">

    <script src="../../static/common/js/bootstrap.min.js"></script>
    <script src="../../static/common/js/jquery.min.js"></script>
    <script src="../../static/common/js/popper.min.js"></script>
</head>
<body>
<h1>修改密码</h1>

<div class="container">
    <div class="form-group">
        <label for="prepasswd">新密码:</label>
        <input type="password" class="form-control" id="prepasswd">
    </div>
    <div class="form-group">
        <label for="newpasswd">确认密码:</label>
        <input type="password" class="form-control" id="newpasswd">
    </div>
    <input type="button" class="btn btn-primary" id="modify" value="修改">
    <h2 id="hint"></h2>
</div>

<script>
    $('#modify').click(function () {

        let prepasswd = $("#prepasswd").val();
        let newpasswd = $("#newpasswd").val();
        if (prepasswd == null && newpasswd == null){
            alert("两次密码不能为空")
            return;
        }
        if (prepasswd.length <= 3 || newpasswd.length <= 3) {
            alert("密码长度需大于3个字符");
            return;
        }
        if (prepasswd !== newpasswd) {
            alert("两次密码不匹配");
            return;
        }
        $.ajax({
            type: 'POST',
            url: '',
            data: {
                csrfmiddlewaretoken: '{{ csrf_token }}',
                'prepasswd': prepasswd,
                'newpasswd': newpasswd,
            },
            success: function (result) {
                if (result.toString() == 'no') {
                    alert("密码修改失败");
                    return;
                } else {
                    window.location.replace('/class/23505/home/');
                }
            },
            error: function (result) {
                alert("错误");
                return;
            }
        });
    })
</script>
</body>
</html>